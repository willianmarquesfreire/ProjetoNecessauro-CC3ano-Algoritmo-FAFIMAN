create generator GEN_TIPO_BENS;

create generator GEN_EST_CONSERVACAO_BENS;

create generator GEN_LOCALIZACAO_BENS;

create generator GEN_MANUTENCAO_BENS;



/******************************************************************************/
/***          Generated by IBExpert 2012.02.21 23/11/2015 22:23:50          ***/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES NONE;

SET CLIENTLIB 'D:\Faculdade\Algoritmo - Rodney\Banco\gds32.dll';

CREATE DATABASE 'C:\banco_dados\ERP.FDB'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 4096
DEFAULT CHARACTER SET NONE COLLATION NONE;



/******************************************************************************/
/***                                 Tables                                 ***/
/******************************************************************************/



CREATE TABLE BENS_IMOBILIZADOS (
    BNI_EMPRESA             INTEGER NOT NULL,
    BNI_CODIGO              INTEGER NOT NULL,
    BNI_NUM_SERIE           INTEGER NOT NULL,
    BNI_NR_NOTA             INTEGER NOT NULL,
    BNI_FORNECEDOR          INTEGER NOT NULL,
    BNI_DESCRICAO           VARCHAR(100) NOT NULL,
    BNI_TIPO                INTEGER NOT NULL,
    BNI_LOCALIZACAO         INTEGER NOT NULL,
    BNI_ESTADO_CONSERVACAO  INTEGER NOT NULL,
    BNI_MANUTENCAO          INTEGER,
    BNI_DATA_AQUISICAO      DATE NOT NULL,
    BNI_VLR_AQUISICAO       NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    BNI_VLR_RESIDUAL        NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    BNI_VLR_AGREGADO        NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    BNI_VLR_ATUAL           NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    BNI_DEPRECIACAO         NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    BNI_OBSERVACAO          BLOB SUB_TYPE 0 SEGMENT SIZE 80,
    BNI_STATUS              VARCHAR(1) default 'A' NOT NULL
);

CREATE TABLE COMPONENTE (
    COM_EMPRESA         INTEGER NOT NULL,
    COM_MANUTENCAO      INTEGER NOT NULL,
    COM_CODIGO          VARCHAR(30) NOT NULL,
    COM_OBSERVACAO      BLOB SUB_TYPE 0 SEGMENT SIZE 80,
    COM_VLR_COMPONENTE  FLOAT DEFAULT 0 NOT NULL
);

CREATE TABLE ESTADO_DE_CONSERVACAO (
    EDC_CODIGO     INTEGER NOT NULL,
    EDC_DESCRICAO  VARCHAR(100) NOT NULL,
    EDC_STATUS     VARCHAR(1) default 'A' NOT NULL
);

CREATE TABLE LOCALIZACAO (
    LOC_CODIGO     INTEGER NOT NULL,
    LOC_DESCRICAO  VARCHAR(100) NOT NULL,
    LOC_STATUS     VARCHAR(1) DEFAULT 'A' NOT NULL
);

CREATE TABLE MANUTENCAO (
    MAN_EMPRESA         INTEGER NOT NULL,
    MAN_CODIGO          INTEGER NOT NULL,
    MAN_BEN             INTEGER NOT NULL,
    MAN_DESCRICAO       VARCHAR(100) NOT NULL,
    MAN_OBSERVACAO      BLOB SUB_TYPE 0 SEGMENT SIZE 80,
    MAN_VLR_COMPONENTE  NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    MAN_VLR_MANUTENCAO  NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    MAN_VLR_TOTAL       NUMERIC(18,2) DEFAULT 0.00 NOT NULL,
    MAN_AGREGA_CUSTO    VARCHAR(1) DEFAULT 'S' NOT NULL,
    MAN_NUM_SERIE       INTEGER NOT NULL
);

CREATE TABLE TIPO_DE_BENS (
    TPB_CODIGO     INTEGER NOT NULL,
    TPB_DESCRICAO  VARCHAR(100) NOT NULL,
    TPB_STATUS     VARCHAR(1) default 'A' NOT NULL
);



/******************************************************************************/
/***                              Primary Keys                              ***/
/******************************************************************************/

ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT PK_BENS_IMOBILIZADOS PRIMARY KEY (BNI_EMPRESA, BNI_CODIGO, BNI_NUM_SERIE);
ALTER TABLE COMPONENTE ADD CONSTRAINT PK_COMPONENTE PRIMARY KEY (COM_EMPRESA, COM_CODIGO);
ALTER TABLE ESTADO_DE_CONSERVACAO ADD CONSTRAINT PK_ESTADO_DE_CONSERVACAO PRIMARY KEY (EDC_CODIGO);
ALTER TABLE LOCALIZACAO ADD CONSTRAINT PK_LOCALIZACAO PRIMARY KEY (LOC_CODIGO);
ALTER TABLE MANUTENCAO ADD CONSTRAINT PK_MANUTENCAO PRIMARY KEY (MAN_EMPRESA, MAN_CODIGO);
ALTER TABLE TIPO_DE_BENS ADD CONSTRAINT PK_TIPO_DE_BENS PRIMARY KEY (TPB_CODIGO);


/******************************************************************************/
/***                              Foreign Keys                              ***/
/******************************************************************************/

ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_EMPRESA FOREIGN KEY (BNI_EMPRESA) REFERENCES EMPRESA (EMP_COD);
ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_ESTCONSERVACAO FOREIGN KEY (BNI_ESTADO_CONSERVACAO) REFERENCES ESTADO_DE_CONSERVACAO (EDC_CODIGO);
ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_LOCALIZACAO FOREIGN KEY (BNI_LOCALIZACAO) REFERENCES LOCALIZACAO (LOC_CODIGO);
ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_NOTA FOREIGN KEY (BNI_EMPRESA, BNI_NR_NOTA, BNI_FORNECEDOR) REFERENCES NOTA_ENTRADA (NTE_EMPRESA, NTE_NR_NOTA, NTE_PESSOA);
ALTER TABLE BENS_IMOBILIZADOS ADD CONSTRAINT FK_BENS_TIPO FOREIGN KEY (BNI_TIPO) REFERENCES TIPO_DE_BENS (TPB_CODIGO);
ALTER TABLE COMPONENTE ADD CONSTRAINT FK_COMPONENTE_MANUTENCAO FOREIGN KEY (COM_EMPRESA, COM_MANUTENCAO) REFERENCES MANUTENCAO (MAN_EMPRESA, MAN_CODIGO);
ALTER TABLE COMPONENTE ADD CONSTRAINT FK_COMPONENTE_PRODUTO FOREIGN KEY (COM_EMPRESA, COM_CODIGO) REFERENCES PRODUTOS (PRO_EMPRESA, PRO_CODIGO);
ALTER TABLE MANUTENCAO ADD CONSTRAINT FK_MANUTENCAO_BENS FOREIGN KEY (MAN_EMPRESA, MAN_BEN, MAN_NUM_SERIE) REFERENCES BENS_IMOBILIZADOS (BNI_EMPRESA, BNI_CODIGO, BNI_NUM_SERIE);